\begin{code}
module LookupRefactor

import VectAsList
import FinAsNat

%default total

\end{code}
%<*lookup>
\begin{code}
lookup : Vect n a -> Fin n -> a
lookup xs@_ k@_ with (view xs) | (view k)
  _ | hd :: _ | Z = hd
  _ | _ :: tl | S k' = lookup tl k'
\end{code}
%</lookup>
